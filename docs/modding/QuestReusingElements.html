<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Reusing Quest elements </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Reusing Quest elements ">
    <meta name="generator" content="docfx 2.59.2.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="reusing-quest-elements">Reusing Quest elements</h1>

<p>There are three additional compiler commands to help you organize the information in a quest for use in new quests you decide to create.</p>
<hr>
<p>The cfg: directive allows you to modify the compiler's notion of what quest elements are available by adding your own item and quest commands to its description of the <strong>Daggerfall</strong> environment.</p>
<h3 id="cfg-afilename">cfg: aFileName</h3>
<p>where aFileName is the name of the configuration file describing your additions.</p>
<p>Your changes will be available for the remainder of compile task.</p>
<p>There is no specific way to revoke your changes until the compile task completes. Once the compiler finishes it forgets about your changes, and so it has to be told about them each time you want to compile a quest that uses those alterations.</p>
<hr>
<p>The src: directive allows you to include another quest file verbatim at the place where the src: directive appears.</p>
<h3 id="src-afilename">src: aFileName</h3>
<p>&lt;src: aFileName&gt;</p>
<p>where aFileName is the name of the quest file that you want to insert into the present quest. Note that the named file doesn't have to be a complete quest. It might be consist of some stock dialog you'd like to include in several quests. Or it might be a series of condition-responses that you'd like to reuse in several different quests.</p>
<p>Use the first form to include quest resources, tasks, and complete Qrc message blocks.</p>
<p>Use the second form to include text within a single Qrc message block. This allows a single set of messages to be reused with different text blocks.</p>
<pre><code>RumoresDuringQuest:
&lt;src: ../src/harth.rum&gt;

RumoresPostfailure:
&lt;src: ../src/harth.rum&gt;

RumoresPostSuccess:
&lt;src: ../src/harth.rum&gt;
</code></pre>
<p>would share the same set of rumors during the quest and regardless of the quest's outcome.</p>
<p>The compiler treats the included text verbatim, just as though you'd typed the file's contents in by hand at that very spot in the quest file. So, the quest elements which are included must make sense in the context where the src: directive appears.</p>
<p>For example, don't expect the compiler to be thrilled if you try to include some Qrc text blocks in the middle of the Qbn section.</p>
<hr>
<h3 id="substitutions">Substitutions</h3>
<p>It's possible to combine the effects of configuration changes with source inclusion.</p>
<p>For example, you may have a series of condition/responses that you'd like to reuse in several different quests. But you don't want to be limited to using the same quest symbols each time.</p>
<p>It's possible to write those quest tasks just once, then tell the compiler how to use them with different items, npcs, and so forth, by writing a <em>macro</em>--which is just a technical word for substituting one thing for another. Since the result of substitution is usually something <em>bigger</em>, the Greek root has stuck with us.</p>
<p>The compiler recognizes the beginning of a macro by the special command macro. And it recognizes the end of a macro by the special command end macro. All the commands between the two are eligible for special substitutions when those commands are actually used.</p>
<h3 id="macro-acommandpattern">macro aCommandPattern</h3>
<p>aCommandPattern tells the compiler how you'd like to refer to the collection of commands between the macro command and the end macro command.</p>
<pre><code>Macro MeetBigP &amp;1 trap &amp;2 foes &amp;3 &amp;4 &amp;5 &amp;6
:
:
End macro
:
:
MeetBigP \_kahuna\_ trap \_dungeon\_ foes \_spider\_ \_bat\_ \_rat\_ \_gargoyle\_
</code></pre>
<p>The macro command tells the compiler how to recognize the new MeetBigP command. When the compiler encounters a subsequent MeetBigP command, it will substitute _kahuna_ for each occurance of &amp;1 within the macro; _dungeon_ for each occurance of &amp;2; _spider_ for each occurance of &amp;3; and so forth.</p>
<p>Suppose the MeetBigP macro looks like this</p>
<p>macro MeetBigP &amp;1 trap &amp;2 foes &amp;3 &amp;4 &amp;5 &amp;6
atP task:
clicked &amp;1
repute with &amp;1 exceeds 34 do _happyP_
repute with &amp;1 exceeds 22 do _smugP_
repute with &amp;1 exceeds 10 do _snideP_
say PopSteamed
change repute with &amp;1 by -4
teleport pc to &amp;2</p>
<p>_snideP_ task:
say PopPeeved
change repute with &amp;1 by -2</p>
<p>_smugP_ task:
say PopOk
change repute with &amp;1 by +2</p>
<p>_happyP_ task:
say PopNice
change repute with &amp;1 by +4</p>
<p>_battle1_ task:
when _smugP_
create &amp;3 every 180 minutes 100 times with 80% success</p>
<p>_battle2_ task:
when _snideP_
create &amp;4 every 165 minutes 100 times with 65% success
create &amp;5 every 180 minutes 100 times with 65% success
create &amp;6 every 191 minutes 100 times with 65% success</p>
<p>end macro</p>
<p>When the compiler encounters the actual use of MeetBigP it notices the matching parts of the definition and replaces the MeetBigP command with the substituted macro lines, as though they had been typed verbatim at that place.</p>
<p>atP task:
clicked _kahuna_
repute with _kahuna_ exceeds 34 do _happyP_
repute with _kahuna_ exceeds 22 do _smugP_
repute with _kahuna_ exceeds 10 do _snideP_
say PopSteamed
change repute with _kahuna_ by -4
teleport pc to _dungeon_</p>
<p>_snideP_ task:
say PopPeeved
change repute with _kahuna_ by -2</p>
<p>_smugP_ task:
say PopOk
change repute with _kahuna_ by +2</p>
<p>_happyP_ task:
say PopNice
change repute with _kahuna_ by +4</p>
<p>_battle1_ task:
when _smugP_
create _spider_ every 180 minutes 100 times with 80% success</p>
<p>_battle2_ task:
when _snideP_
create _bat_ every 165 minutes 100 times with 65% success
create _rat_ every 180 minutes 100 times with 65% success
create _gargoyle_ every 191 minutes 100 times with 65% success</p>
<p>If another quest had different NPC, say _queen_, with whom the same sort of behavior is needed, but perhaps with nastier foes, the MeetBigP command can be used with different elements:</p>
<pre><code>MeetBigP \_queen\_ trap \_remoteTown\_ foes \_nymph\_ \_vampire\_ \_knight\_ \_lich\_
</code></pre>
<p>which would result in the same set of actions, but tailored with a different NPC and foes.</p>
<p>Any part of a macro can be tailored. You aren't particularly limited to NPCs or foes. Instead of varying the types of foes, the command could have chosen to vary the frequency of attacks for example.</p>
<p>However, you cannot write a macro which substitutes a command name at all. Replacing all the <em>repute</em> commands in MeetBigP with &amp;7 won't let you change that command on the fly each time the MeetBigP macro is used.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/TheLacus/daggerfall-unity-docs/blob/master/modding/QuestReusingElements.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
